<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
    <title>Admin page</title>
    <head>
        <body>
            <div class="navbar">
                Mini fleet management
            </div>
            <div class="container">
                <div class="sidebar"></div>
                <h3>Add Fleet</h3>

                <label>Reg No of Vehicle:
                    <input type="text" id="regNo">
                </label>
                <br></br>

                <label>
                    Category:
                    <select id="category">
                        <option value="">Select</option>
                        <option value="Auto">Auto</option>
                        <option value="Car">Car</option>
                        <option value="Truck">Truck</option>
                        <option value="Bus">Bus</option>

                    </select>
                </label>
                <br></br>

                <label>Driver Name:
                    <input type="text" id="driver">

                </label> 
                <br></br>
                <label>Is Available:
                    <select id="isAvail">
                        <option value="Available" >Available</option>
                        <option value="Unavailable" >Unavailable</option>

                    </select>
                </label> 
                <br></br>

                <button id="addFleetBtn">Add Fleet</button>
                <!-- </div> -->

                <div class="main" id="cardsArea"></div>
                </div>

                <script>
                    let fleet=[];
                    const regNoInp=document.getElementById("regNo");
                    const catInp=document.getElementById("category");
                    const driverInp=document.getElementById("driver");
                    const isAvailInp=document.getElementById("isAvail");
                    const addBtn=document.getElementById("addFleetBtn");
                    const cardsArea=document.getElementById("CardsArea");
                    const imgSrc="vehicles.png";

                    addBtn.addEventListener("click",function(){
                        const reg=regNoInp.value.trim();
                        const cat=catInp.value;
                        const drv=driverInp.value.trim();
                        const avl=isAvailInp.value;
                        if(!reg||!cat||!drv||!avl){
                            alert("Please fill all fields");
                        }
                        const vehicle={
                            regNo:reg,
                            category:cat,
                            driver:drv,
                            availability:avl
                        };
                        fleet.push(vehicle);
                        regNoInp.value="";
                        catInp.value="";
                        driverInp.value="";
                        isAvailInp.value="Available";
                         
                        renderCards();
                        function renderCards(){
                            cardsArea.innerHTML="";

                            fleet.forEach(function (v){
                                const card=document.createElement("div");
                                card.className="card";

                                card.innerHTML=`<img src="${imgSrc}" alt="vehicle">
                                <p><b>Reg No:</b> ${v.regNo} </p>
                                <p><b>Category:</b> ${v.category} </p>
                                <p><b>Driver:</b> ${v.driver} </p>
                                <p><b>Status:</b>${v.availability}</p>

                                <button class="updateBtn">Update Driver</button>
                                <button class="changeBtn">Change Availability</button>
                                <button class="deleteBtn">Delete Vehicle</button>

                                `;

                                //1 update driver button
                                const updateBtn=card.querySelector(".updateBtn");
                                updateBtn.addEventListener("click",function(){
                                    const newName=prompt("Enter new driver name:",v.driver);
                                    if(newName&newName.trim()!==""){
                                        v.driver=newName.trim();
                                        renderCards();
                                    }
                                });

                                //2 change availability
                                const changeBtn=card.querySelector(".changeBtn");
                                changeBtn.addEventListener("click",function(){
                                    if(v.availability==="Available"){
                                        v.availability="Unavailabile";
                                    }
                                    else{
                                        v.availability="Available";
                                    }
                                    renderCards();
                                });

                                //3 Delete vehicle button
                                const deleteBtn=card.querySelector(".deleteBtn");
                                deleteBtn.addEventListener("click",function(){
                                    fleet=fleet.filter(function(_,i){
                                        return i !==index;
                                    });
                                    renderCards();
                                });
                                cardsArea.appendChild(card);

                            });
                        }
                    })


                </script>


                <div class="main" id="cardsArea">

                </div>
            </div>
        </body>
    </head>